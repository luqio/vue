<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="text/javascript">
        function createXHR() {
            if(typeof XMLHttpRequest != 'undefined'){
                return new XMLHttpRequest();
            }else if(typeof ActiveXObject != "undefined"){
                if(typeof arguments.callee.activeXString!="string"){
                    var versions = ["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp"],
                    i = 0,
                    len = versions.length;
                    for(; i<len; i++){
                        try{
                            new ActiveXObject(versions[i]);
                            arguments.callee.activeXString = versions[i]
                        }catch{}
                    }
                }
                return new ActiveXObject(arguments.callee.activeXString);
            }else{
                throw new Error("您的浏览器并不支持AJAX.")
            }
        }

        var createXHR = (function () {
            if(typeof XMLHttpRequest != 'undefined'){
                return function(){
                    new XMLHttpRequest();
                }
            }else if(typeof ActiveXObject != "undefined"){
                if(typeof arguments.callee.activeXString!="string"){
                    var versions = ["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp"],
                    i = 0,
                    len = versions.length;
                    for(; i<len; i++){
                        try{
                            new ActiveXObject(versions[i]);
                            arguments.callee.activeXString = versions[i]
                        }catch{}
                    }
                }
                return function(){
                    return new ActiveXObject(arguments.callee.activeXString);
                }
            }else{
                return function(){
                    throw new Error("您的浏览器并不支持AJAX.")
                }
            }
        })();

        function createXHR() {
            if(typeof XMLHttpRequest != 'undefined'){
                createXHR = function(){ return new XMLHttpRequest();};
            }else if(typeof ActiveXObject != "undefined"){
                if(typeof arguments.callee.activeXString!="string"){
                    var versions = ["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp"],
                    i = 0,
                    len = versions.length;
                    for(; i<len; i++){
                        try{
                            new ActiveXObject(versions[i]);
                            arguments.callee.activeXString = versions[i]
                        }catch{}
                    }
                }
                createXHR = function(){ return new ActiveXObject(arguments.callee.activeXString);};
            }else{
                createXHR = function(){ throw new Error("您的浏览器并不支持AJAX.")};
            }
            return createXHR();
        }
    </script>
</head>
<body>

</body>
</html>